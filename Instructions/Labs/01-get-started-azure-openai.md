---
lab:
  title: 开始使用 Azure OpenAI
---

# 开始使用 Azure OpenAI 服务

Azure OpenAI 服务将 OpenAI 开发的生成式 AI 模型引入 Azure 平台，使你能够开发功能强大的 AI 解决方案，这些解决方案受益于 Azure 云平台提供的服务的安全性、可伸缩性和集成。 在本练习中，你将了解如何通过将服务预配为 Azure 资源并使用 Azure OpenAI Studio 部署和探索 OpenAI 模型来开始使用 Azure OpenAI。

此练习大约需要 30 分钟。

## 准备工作

你将需要使用已被批准访问 Azure OpenAI 服务的 Azure 订阅。

- 若要注册免费的 Azure 订阅，请访问 [https://azure.microsoft.com/free](https://azure.microsoft.com/free)。
- 若要请求访问 Azure OpenAI 服务，请访问 [https://aka.ms/oaiapply](https://aka.ms/oaiapply)。

## 预配 Azure OpenAI 资源

必须先在 Azure 订阅中预配 Azure OpenAI 资源，然后才能使用 Azure OpenAI 模型。

1. 登录到 [Azure 门户](https://portal.azure.com)。
2. 请使用以下设置创建 Azure OpenAI 资源：
    - 订阅：已被批准访问 Azure OpenAI 服务的 Azure 订阅。
    - **资源组**：使用你所选择的名称创建新资源组。
    - 区域：任选一个可用的区域。
    - 名称：所选项的唯一名称。
    - 定价层：标准版 S0
3. 等待部署完成。 然后在 Azure 门户中转至部署的 Azure OpenAI 资源。

## 部署模型

Azure OpenAI 提供了一个名为 Azure OpenAI Studio 的基于 Web 的门户，可用于部署、管理和探索模型。 你将使用 Azure OpenAI Studio 部署模型，开始探索 Azure OpenAI。

1. 在 Azure OpenAI 资源的“概述”页上，使用“浏览”按钮在新的浏览器选项卡中打开 Azure OpenAI Studio 。
2. 在 Azure OpenAI Studio 中，使用以下设置创建新部署：
    - 模型名称：text-davinci-003
    - 部署名称：text-davinci

> 注意：Azure OpenAI 包含多个模型，每个模型针对功能和性能的不同平衡进行优化。 在本练习中，你将从 GPT-3 系列文本生成模型中的 Davinci 模型开始 。 text-davinci-003 是用于总结和生成自然语言的良好通用模型。 有关 Azure OpenAI 中可用模型的详细信息，请参阅 Azure OpenAI 文档中的[模型](https://learn.microsoft.com/azure/cognitive-services/openai/concepts/models)。

## 在“完成”操场中探索模型

操场是 Azure OpenAI Studio 中的有用接口，可用于试验部署的模型，而无需开发自己的客户端应用程序。

1. 在 Azure OpenAI Studio 中，在“操场”下的左窗格中，选择“完成” 。
2. 在“完成”页中，确保已选择 text-davinci 部署，然后在“示例”列表中选择“总结文章（抽象）”   。

    “总结文本”示例包含一个提示，该提示提供一些文本，从“提供以下文本的摘要...”行开始。使用此句子启动提示会告知模型总结以下文本块。

3. 在页面底部，注意文本中检测到的标记数。 标记是提示的基本单位 - 实质上是文本中的单词或单词的部分。
4. 使用“生成”按钮将提示提交到模型并检索响应。

    响应包含原始文本的摘要。 摘要应以不太详细的语言传达原始文本的关键点。

5. 使用“重新生成”按钮重新提交提示，请注意，响应可能与原始响应不同。 生成式 AI 模型可以在每次调用时生成新语言。
6. 在总结的响应下，添加新行并输入以下文本：

    *AI 是如何进步的？*

7. 使用“生成”按钮提交新提示并查看响应。 前面的提示和响应在与模型的持续对话中提供上下文，使模型能够生成针对问题的适当答案。
8. 将提示的全部内容替换为以下文本：

    *提供以下文本的摘要，以捕获其主要意思。* 
    
    *Azure OpenAI 服务提供对 OpenAI 的强大语言模型（包括 GPT-4、Codex 和 Embeddings 模型系列）的 REST API 访问。这些模型可以轻松适应特定任务，包括但不限于内容生成、摘要、语义搜索和自然语言到代码翻译。用户可以通过 REST API、Python SDK 或 Azure OpenAI Studio 中基于 Web 的界面访问该服务。*

9. 使用“生成”按钮提交新提示，并验证模型是否适当地总结了文本。

## 使用模型对文本进行分类

到目前为止，你已了解如何使用模型来总结文本。 但是，Azure OpenAI 中的生成式模型可以支持一系列不同类型的任务。 让我们探讨另一个示例：文本分类。

1. 在“完成”页中，确保已选择 text-davinci 部署，然后在“示例”列表中选择“对文本分类”   。

    对文本分类示例提示以指令的形式描述模型的上下文，以将新闻文章分类为一系列类别之一。 然后，它提供新闻文章的文本（以“新闻文章：”为前缀），结尾是“分类类别：” 。 目的是让模型通过预测适当的类别来“完成”提示的最后一行。

2. 使用“生成”按钮将提示提交到模型并检索响应。 模型应预测新闻文章的适当类别。
3. 在预测类别下，添加以下文本：

    *新闻文章：Microsoft 发布 Azure OpenAI 服务。Microsoft Corporation 发布了一项 Azure 服务，该服务使 OpenAI 模型可供在 Azure 云中构建应用和服务的应用程序开发人员使用。*

    *分类类别：*

4. 使用“生成”按钮继续与模型对话，并为新的新闻文章生成适当的分类。

## 探索提示和参数

到目前为止，你已根据 Azure OpenAI Studio 中提供的示例来提供提示。 让我们尝试一些不同的方法。

1. 将提示区域中的所有文本替换为以下文本：

    *你是一名教师，为学生创建测试。*

    *根据以下文本编写三个多选题。*

    *大多数计算机视觉解决方案都基于机器学习模型，这些模型可应用于来自相机、视频或图像的视觉输入。*

    *\- 图像分类涉及训练机器学习模型，使其根据图像内容对图像进行分类。例如，你可以在交通监控解决方案中使用图像分类模型，根据图像所包含的车辆类型（例如出租车、公共汽车、骑自行车的人等）对图像进行分类。*

    *\- 物体检测机器学习模型经过训练，可对图像中的各物体进行分类，并使用范围框标识其位置。例如，交通监视解决方案可能会使用物体检测来标识不同类别车辆的位置。*

    *\- 语义分段是一种高级机器学习技术，其中图像中的单个像素根据它们所属的物体进行分类。例如，交通监视解决方案可能会用“掩盖”层覆盖交通图像，以使用特定颜色突出显示不同的车辆。*

2. 在“参数”窗格中，设置以下参数值：
    - 温度：0
    - 最大长度（标记）：500
    - 响应前文本：自动生成的问题。 在测试中使用之前进行验证：
3. 使用“生成”按钮提交提示并查看结果，结果应包含响应前文本参数中的值，后跟教师可用于在提示中针对计算机视觉主题对学生进行测试的多项选择题。 总响应应小于指定为参数的最大长度。

    观察以下有关你使用的提示和参数的内容：

    - 提示包括指示模型行为方式的自然语言上下文信息。 具体而言，它指示模型应承担教师为学生创建测试的角色。
    - 参数包括“温度”，它控制响应生成包含随机性元素的程度。 提交中使用的值 0 可最大程度地减小随机性，从而生成稳定、可预测的响应。

4. 使用“重新生成”按钮重新生成响应。 它应类似于上一个响应。
5. 将“温度”参数值更改为 0.9，然后使用“重新生成”按钮重新生成响应  。 这一次，增加的随机性应会生成不同的响应。 但是，与以前生成的响应中的问题相比，这些问题更有可能包含不准确之处。

## 探索代码生成

部署的 text-davinci 模型是一个不错的可很好地处理大多数任务的常规模型。 但是，在某些情况下，最好选择针对特定类型的任务优化的模型。 例如，Azure openAI 模型可用于生成计算机代码而不是自然语言文本，并且某些模型已针对该任务进行了优化。

1. 在 Azure OpenAI Studio 中，查看“模型”页；其中列出了 Azure OpenAI 服务资源中的所有可用模型。
2. 选择 code-davinci-002 模型，并使用“部署模型”按钮部署它，部署名称为 code-davinci  。
3. 部署完成后，在 Azure OpenAI Studio 中查看“部署”页；其中列出了已部署的模型。
4. 选择 code-davinci 模型部署，并使用“在操场中打开”按钮以在操场中打开它 。
5. 在“完成”页中，确保已选择 code-davinci 部署，然后在“示例”列表中选择“自然语言到 SQL”   。

    “自然语言到 SQL”示例提示提供数据库中表的详细信息，以及所需的查询说明，后跟 `SELECT`关键字。 目的是让模型完成 `SELECT` 语句以创建满足要求的查询。

6. 使用“生成”按钮将提示提交到模型并检索响应，其中包含 SQL `SELECT` 查询。
7. 将整个提示和响应替换为以下新提示：

    *# Python 3*

    *# 创建用于打印“Hello”和指定字符串的函数*

    *def print_hello(s):*

8. 使用“生成”按钮提交提示并查看生成的代码。 提示包括要生成的编程语言 (Python 3) 的指示、描述所需功能的注释以及函数定义的第一部分。 code-davinci 模型应已使用适当的 Python 代码完成函数。

## 探索聊天模型

ChatGPT 是由 OpenAI 开发的聊天机器人，可在对话场景中提供各种自然语言响应。 ChatGPT 使用的模型和用于使用它的 API 包含在 Azure OpenAI 中。

1. 在 Azure OpenAI Studio 中，查看“模型”页；其中列出了 Azure OpenAI 服务资源中的所有可用模型。
2. 选择 gpt-35-turbo 模型，并使用“部署模型”按钮部署它，部署名称为 gpt-chat  。
3. 部署模型后，在“操场”部分选择“聊天”页，并确保在右侧窗格中选择了 gpt-chat 模型。  
4. 在“助理设置”部分的“系统消息”框中，将当前文本替换为以下内容： 

    *该系统是一个 AI 教师，可帮助人们了解 AI*

5. 在“系统消息”框下方，单击“添加少量示例”，然后在指定的框中输入以下消息和响应： 

    用户：人工智能有哪些不同类型？

    助手：有三种主要类型的人工智能：狭义或弱 AI（如 Siri 或 Alexa 等虚拟助手、图像识别软件和垃圾邮件筛选器）、常规或强 AI（AI 设计为具有与人一样的智能。这种类型的 AI 目前不存在，纯粹是理论性的），以及人工超级智能（比任何人类都更智能且可以执行人类无法理解的任务的 AI。这种类型的 AI 也纯粹是理论性的，尚未开发）。

    > 注意：使用少量示例为模型提供预期响应类型的示例。 模型将尝试在自己的响应中反映示例的语气和风格。

6. 保存更改以启动新会话并设置聊天系统的行为上下文。

7. 在页面底部的查询框中，输入以下文本：

    *什么是人工智能？*

8. 使用“发送”按钮提交消息并查看响应。

    > 注意：可能会收到 API 部署尚未就绪的响应。 如果是，请等待几分钟，然后重试。

9. 查看响应，然后提交以下消息以继续对话：

    *它与机器学习有何关系？*

10. 查看响应，指出上一个交互的上下文会保留（以便模型理解“它”是指人工智能）。

在本练习中，你已了解如何在 Azure 订阅中预配 Azure openAI 服务，以及如何使用 Azure OpenAI Studio 来部署和探索模型。

开发人员可以使用 REST 接口和特定语言的 API 来创建使用 Azure OpenAI 模型的应用和服务；使你能够在自己的应用程序中利用生成式 AI 模型。 其他练习中介绍了针对 Azure OpenAI 进行编码。
